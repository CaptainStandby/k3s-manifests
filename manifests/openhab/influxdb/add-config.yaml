apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: influxdb
spec:
  template:
    spec:
      containers:
      - name: influxdb
        env:
          - name: DOCKER_INFLUXDB_INIT_MODE
            value: setup
          - name: DOCKER_INFLUXDB_INIT_USERNAME
            value: admin
          - name: DOCKER_INFLUXDB_INIT_PASSWORD
            value: qwertz # TODO: Change this
          - name: DOCKER_INFLUXDB_INIT_ORG
            value: main
          - name: DOCKER_INFLUXDB_INIT_BUCKET
            value: default
          # The duration the system's initial bucket should retain data. If not set, the initial bucket will retain data forever.
          # - name: DOCKER_INFLUXDB_INIT_RETENTION
          #   value: {{ .Values.adminUser.retention_policy }}
          # The authentication token to associate with the system's initial super-user. If not set, a token will be auto-generated by the system.
          # - name: DOCKER_INFLUXDB_INIT_ADMIN_TOKEN
          #   valueFrom:
          #     secretKeyRef:
          #       {{- if .Values.adminUser.existingSecret }}
          #       name: {{ .Values.adminUser.existingSecret -}}
          #       {{ else }}
          #       name: {{ template "influxdb.fullname" . }}-auth
          #       {{- end }}
          #       key: admin-token
